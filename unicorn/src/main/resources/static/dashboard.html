<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unicorn - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
        }
        .welcome-section {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .stats-card:hover {
            transform: translateY(-5px);
        }
        .btn-logout {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            border: none;
            border-radius: 10px;
            padding: 8px 20px;
            color: white;
            font-weight: 600;
        }
        .btn-logout:hover {
            background: linear-gradient(45deg, #ee5a52, #ff6b6b);
            color: white;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">ü¶Ñ Unicorn</a>
            <div class="navbar-nav ms-auto">
                <button class="btn btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="dashboard-card">
            <div class="welcome-section text-center">
                <h1>Welcome to Your Dashboard!</h1>
                <p class="lead mb-0">You are successfully authenticated with JWT</p>
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="stats-card text-center">
                        <h3>üîê</h3>
                        <h4>Authentication</h4>
                        <p class="text-success">Active</p>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="stats-card text-center">
                        <h3>üõ°Ô∏è</h3>
                        <h4>Security</h4>
                        <p class="text-success">Protected</p>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="stats-card text-center">
                        <h3>‚ö°</h3>
                        <h4>Performance</h4>
                        <p class="text-success">Optimal</p>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>‚òÅÔ∏è UWS-S3 Cloud Storage</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Manage your cloud storage buckets and files</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create and manage storage buckets</li>
                                        <li>Upload files to buckets</li>
                                        <li>Download and delete files</li>
                                        <li>Secure file access with JWT</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-s3.html" class="btn btn-primary btn-lg">
                                        <i class="fas fa-cloud"></i> Access UWS-S3
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>‚ö° UWS-Compute Container Service</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Deploy and manage Docker containers in the cloud</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Deploy Docker containers with custom configurations</li>
                                        <li>Choose from micro, small, and medium instance sizes</li>
                                        <li>Start, stop, and delete containers</li>
                                        <li>Schedule container execution with cron expressions</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-compute.html" class="btn btn-success btn-lg">
                                        <i class="fas fa-server"></i> Access UWS-Compute
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üöÄ UWS-Lambda Function Service</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Create and execute serverless functions in isolated containers</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create JavaScript and Python lambda functions</li>
                                        <li>Execute code in secure isolated environments</li>
                                        <li>Monitor execution logs and performance</li>
                                        <li>Resource limits and timeout protection</li>
                                        <li>Syntax highlighting with Monaco Editor</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-lambda.html" class="btn btn-warning btn-lg">
                                        <i class="fas fa-code"></i> Access UWS-Lambda
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üóÑÔ∏è UWS-RDB Relational Database Service</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Create, manage, and query your relational database instances</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create database instances with custom CPU, RAM, and storage limits</li>
                                        <li>Execute SQL queries (CREATE, INSERT, SELECT, UPDATE, DELETE)</li>
                                        <li>Manage multiple tables per database instance</li>
                                        <li>Secure PostgreSQL-based database service with JWT authentication</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-rdb.html" class="btn btn-info btn-lg">
                                        <i class="fas fa-database"></i> Access UWS-RDB
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üì® UWS-SQS Message Queue Service</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Create, manage, and monitor your message queues with secure JWT authentication</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create message queues with custom visibility timeout and retention settings</li>
                                        <li>Send and receive messages with automatic visibility timeout handling</li>
                                        <li>Peek at messages without consuming them</li>
                                        <li>Delete messages after processing with secure user isolation</li>
                                        <li>Real-time message monitoring and queue statistics</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-sqs.html" class="btn btn-warning btn-lg">
                                        <i class="fas fa-envelope-open-text"></i> Access UWS-SQS
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>ü§ñ UWS-AI Serverless AI Inference Service</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Deploy and invoke AI functions with ease. Powered by advanced machine learning models.</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create AI functions with prebuilt models (Sentiment Analysis, Image Labeling, Code Explainer)</li>
                                        <li>Support for text, image, and code input types</li>
                                        <li>Real-time AI inference with mock outputs</li>
                                        <li>Execution history tracking and performance monitoring</li>
                                        <li>Resource limits and daily execution quotas</li>
                                        <li>Secure JWT authentication and user isolation</li>
                                        <li>Modern drag-and-drop interface for image uploads</li>
                                        <li>Integration with UWS-Lambda for workflow automation</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-ai.html" class="btn btn-primary btn-lg">
                                        <i class="fas fa-brain"></i> Access UWS-AI
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üîê UWS-Secrets Manager</h5>
                        </div>
                        <div class="card-body">
                            <p class="lead">Secure secret management with AES-256 encryption and JWT authentication</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Features:</h6>
                                    <ul>
                                        <li>Create and manage secrets with strong AES-256 encryption</li>
                                        <li>Secure secret storage with automatic encryption/decryption</li>
                                        <li>Secret versioning and expiration date management</li>
                                        <li>User isolation - secrets belong only to authenticated users</li>
                                        <li>Modern UI with copy-to-clipboard functionality</li>
                                        <li>Real-time statistics and expiration monitoring</li>
                                    </ul>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a href="/uws-secrets.html" class="btn btn-danger btn-lg">
                                        <i class="fas fa-key"></i> Access UWS-Secrets Manager
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üîë JWT Token Information</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Token Status:</strong> <span class="badge bg-success">Valid</span></p>
                                    <p><strong>Token Type:</strong> JWT (JSON Web Token)</p>
                                    <p><strong>Expiration:</strong> 10 days from login</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Algorithm:</strong> HS512</p>
                                    <p><strong>Issuer:</strong> Unicorn Auth System</p>
                                    <p><strong>Subject:</strong> <span id="userEmail">Loading...</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>üìã API Endpoints</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Endpoint</th>
                                            <th>Method</th>
                                            <th>Description</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><code>/api/auth/register</code></td>
                                            <td>POST</td>
                                            <td>User registration</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/auth/login</code></td>
                                            <td>POST</td>
                                            <td>User authentication</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/uws-rdb/instances</code></td>
                                            <td>GET/POST</td>
                                            <td>Database instances management</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/uws-rdb/instances/{id}/query</code></td>
                                            <td>POST</td>
                                            <td>Execute SQL queries</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/uws-sqs/queues</code></td>
                                            <td>GET/POST</td>
                                            <td>Queue management</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/uws-sqs/queues/{id}/messages</code></td>
                                            <td>GET/POST</td>
                                            <td>Message operations</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/h2-console</code></td>
                                            <td>GET</td>
                                            <td>Database console</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/lambdas</code></td>
                                            <td>POST</td>
                                            <td>Create lambda function</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/lambdas</code></td>
                                            <td>GET</td>
                                            <td>List user lambdas</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/lambdas/{id}/execute</code></td>
                                            <td>POST</td>
                                            <td>Execute lambda function</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/lambdas/{id}/logs</code></td>
                                            <td>GET</td>
                                            <td>Get execution logs</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/lambdas/{id}</code></td>
                                            <td>DELETE</td>
                                            <td>Delete lambda function</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets</code></td>
                                            <td>POST</td>
                                            <td>Create new secret</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets</code></td>
                                            <td>GET</td>
                                            <td>List user secrets (metadata only)</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets/{id}</code></td>
                                            <td>GET</td>
                                            <td>Get secret with decrypted value</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets/{id}</code></td>
                                            <td>PUT</td>
                                            <td>Update secret</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets/{id}</code></td>
                                            <td>DELETE</td>
                                            <td>Delete secret</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/secrets/stats</code></td>
                                            <td>GET</td>
                                            <td>Get secret statistics</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions</code></td>
                                            <td>GET</td>
                                            <td>List user AI functions</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions</code></td>
                                            <td>POST</td>
                                            <td>Create new AI function</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions/{id}/invoke</code></td>
                                            <td>POST</td>
                                            <td>Invoke AI function with text/code</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions/{id}/invoke-image</code></td>
                                            <td>POST</td>
                                            <td>Invoke AI function with image</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions/{id}/history</code></td>
                                            <td>GET</td>
                                            <td>Get execution history</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/functions/{id}</code></td>
                                            <td>DELETE</td>
                                            <td>Delete AI function</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/statistics</code></td>
                                            <td>GET</td>
                                            <td>Get AI service statistics</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/models</code></td>
                                            <td>GET</td>
                                            <td>Get available AI models</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td><code>/api/ai/types</code></td>
                                            <td>GET</td>
                                            <td>Get available function types</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if user is authenticated
        window.addEventListener('load', function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                console.log('No JWT token found, redirecting to login');
                window.location.href = '/login.html';
                return;
            }

            console.log('JWT token found, proceeding to dashboard');
            
            // Decode JWT token to get user email
            try {
                const payload = JSON.parse(atob(token.split('.')[1]));
                document.getElementById('userEmail').textContent = payload.sub || 'Unknown';
                console.log('User email from token:', payload.sub);
            } catch (error) {
                console.error('Error decoding token:', error);
                document.getElementById('userEmail').textContent = 'Error decoding token';
            }
        });

        function logout() {
            localStorage.removeItem('jwtToken');
            alert('Logged out successfully!');
            window.location.href = '/index.html';
        }

        // Auto-logout when token expires (check every minute)
        setInterval(function() {
            const token = localStorage.getItem('jwtToken');
            if (token) {
                try {
                    const payload = JSON.parse(atob(token.split('.')[1]));
                    const expirationTime = payload.exp * 1000; // Convert to milliseconds
                    const currentTime = Date.now();
                    
                    if (currentTime >= expirationTime) {
                        alert('Your session has expired. Please login again.');
                        logout();
                    }
                } catch (error) {
                    console.error('Error checking token expiration:', error);
                }
            }
        }, 60000); // Check every minute
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 